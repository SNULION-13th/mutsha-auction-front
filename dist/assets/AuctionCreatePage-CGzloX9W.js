import{o as p,_ as b,n as m,s as h,d,j as e,r as g,e as o,C as j,f as N,h as w,u as C,i as v,k as S,F as y,B as M,R as P}from"./index-Bg_FgRHp.js";const F="data:image/svg+xml,%3csvg%20width='63'%20height='64'%20viewBox='0%200%2063%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M52.2309%2021.1128L38.4497%207.33156C38.173%207.05457%2037.7977%206.89878%2037.4062%206.89844H13.7812C12.8675%206.89844%2011.9912%207.26142%2011.345%207.90755C10.6989%208.55367%2010.3359%209.43%2010.3359%2010.3438V53.6562C10.3359%2054.57%2010.6989%2055.4463%2011.345%2056.0925C11.9912%2056.7386%2012.8675%2057.1016%2013.7812%2057.1016H49.2188C50.1325%2057.1016%2051.0088%2056.7386%2051.655%2056.0925C52.3011%2055.4463%2052.6641%2054.57%2052.6641%2053.6562V22.1562C52.6637%2021.7648%2052.5079%2021.3895%2052.2309%2021.1128ZM38.8828%2011.9384L47.6241%2020.6797H38.8828V11.9384ZM49.2188%2054.1484H13.7812C13.6507%2054.1484%2013.5255%2054.0966%2013.4332%2054.0043C13.3409%2053.912%2013.2891%2053.7868%2013.2891%2053.6562V10.3438C13.2891%2010.2132%2013.3409%2010.088%2013.4332%209.99572C13.5255%209.90342%2013.6507%209.85156%2013.7812%209.85156H35.9297V22.1562C35.9297%2022.5479%2036.0853%2022.9234%2036.3622%2023.2003C36.6391%2023.4772%2037.0146%2023.6328%2037.4062%2023.6328H49.7109V53.6562C49.7109%2053.7868%2049.6591%2053.912%2049.5668%2054.0043C49.4745%2054.0966%2049.3493%2054.1484%2049.2188%2054.1484Z'%20fill='%23ADADAD'/%3e%3c/svg%3e",R=p({title:h().min(1,"상품명을 입력해주세요.").max(100,"상품명은 100자 이내로 입력해주세요."),description:h().min(1,"상품 설명을 입력해주세요.").max(1e3,"상품 설명은 1000자 이내로 입력해주세요."),startPrice:m().min(1,"시작가는 최소 1잔 이상이어야 합니다.").max(999999,"시작가는 999,999잔을 초과할 수 없습니다."),image:b(File,{message:"사진을 등록해주세요."}).refine(t=>t.size<=5*1024*1024,{message:"이미지 크기는 5MB 이하여야 합니다."}).refine(t=>t.type.startsWith("image/"),{message:"이미지 파일만 업로드 가능합니다."}),duration:p({days:m().min(0).max(365),hours:m().min(0).max(23),minutes:m().min(0).max(59)}).refine(t=>t.days*24*60+t.hours*60+t.minutes>=1,{message:"경매 기간은 최소 1분 이상이어야 합니다."})}),A=()=>{const{register:t,formState:{errors:s}}=d();return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-lg font-bold text-scale-600",children:"상품명"}),e.jsx("input",{...t("title"),placeholder:"예: 빈티지 가죽 자켓",className:"w-full h-14 rounded-md border border-scale-200 focus:border-brand-primary outline-none px-4 text-base text-scale-500 placeholder:text-scale-300"}),s.title&&e.jsx("p",{className:"text-point-warning text-base mt-1",children:s.title.message})]})},D=()=>{const{register:t,formState:{errors:s}}=d();return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-lg font-bold text-scale-600",children:"상품 설명"}),e.jsx("textarea",{...t("description"),placeholder:"상품의 상태, 사용 이력, 특징 등을 작성해주세요.",className:"w-full min-h-36 rounded-md border border-scale-200 focus:border-brand-primary outline-none p-4 text-base text-scale-500 placeholder:text-scale-300"}),s.description&&e.jsx("p",{className:"text-point-warning text-base mt-1",children:s.description.message})]})},O=()=>{const{control:t}=d(),[s,r]=g.useState(null),i=g.useRef(null);return e.jsx(o,{name:"image",control:t,render:({field:{onChange:a,value:n},fieldState:{error:l}})=>(g.useEffect(()=>{if(!n){r(null);return}const c=URL.createObjectURL(n);return r(c),()=>URL.revokeObjectURL(c)},[n]),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-lg font-bold text-scale-600",children:"사진"}),e.jsxs("div",{onClick:()=>i.current?.click(),className:`w-full h-[320px] rounded-md border ${s?"border-transparent":"border-scale-200"} overflow-hidden cursor-pointer flex items-center justify-center`,title:s?"클릭하여 다른 사진으로 변경":"클릭 ",children:[s?e.jsx("img",{src:s,alt:"preview",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"flex flex-col items-center gap-4 text-scale-300",children:[e.jsx("img",{src:F,className:"w-16 opacity-60"}),e.jsx("div",{className:"text-base",children:"클릭하여 업로드 또는 드래그 앤 드롭"})]}),e.jsx("input",{ref:i,type:"file",accept:"image/*",className:"hidden",onChange:c=>{const x=c.target.files?.[0];x&&a(x)}})]}),l&&e.jsx("p",{className:"text-point-warning text-base mt-1",children:l.message})]}))})};function u(t){return t.replace(/\D+/g,"")}function V(t){const s=((t.days*24+t.hours)*60+t.minutes)*60*1e3;return new Date(Date.now()+s).toISOString()}function I(){const{control:t}=d();return e.jsx(o,{name:"startPrice",control:t,render:({field:{onChange:s,value:r},fieldState:{error:i}})=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-lg font-bold text-scale-600",children:"시작가"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("img",{src:j,className:"w-10"}),e.jsx("input",{inputMode:"numeric",value:r||"",onChange:a=>{const n=u(a.target.value);s(n?Number(n):0)},className:"w-24 text-3xl font-bold text-brand-primary bg-transparent border-b-2 border-scale-300 focus:border-brand-primary outline-none text-center"}),e.jsx("span",{className:"text-3xl font-bold text-scale-500",children:"잔"})]}),i&&e.jsx("p",{className:"text-point-warning text-base mt-1",children:i.message})]})})}const f=({label:t,onChange:s,value:r})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{inputMode:"numeric",value:r,onChange:s,className:"w-16 text-3xl font-bold bg-transparent border-b-2 border-scale-300 focus:border-brand-primary outline-none text-center"}),e.jsx("span",{className:"text-3xl pb-1",children:t})]}),E=()=>{const{control:t,formState:{errors:s}}=d();return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-lg font-bold text-scale-600",children:"경매 기간"}),e.jsxs("div",{className:"flex items-center gap-5 text-scale-500",children:[e.jsx(o,{name:"duration.days",control:t,render:({field:{onChange:r,value:i}})=>e.jsx(f,{label:"d",onChange:a=>{const n=u(a.target.value),l=n?Number(n):0;r(Math.min(l,365))},value:String(i)})}),e.jsx(o,{name:"duration.hours",control:t,render:({field:{onChange:r,value:i}})=>e.jsx(f,{label:"h",onChange:a=>{const n=u(a.target.value),l=n?Number(n):0;r(Math.min(l,23))},value:String(i).padStart(2,"0")})}),e.jsx(o,{name:"duration.minutes",control:t,render:({field:{onChange:r,value:i}})=>e.jsx(o,{name:"duration.minutes",control:t,render:({field:{onChange:a,value:n}})=>e.jsx(f,{label:"m",onChange:l=>{const c=u(l.target.value),x=c?Number(c):0;a(Math.min(x,59))},value:String(n).padStart(2,"0")})})})]}),s.duration&&e.jsx("p",{className:"text-point-warning text-base mt-1",children:s.duration.message})]})};function H(){return N({mutationFn:async t=>w({title:t.title,description:t.description,startingPrice:t.startPrice,endTime:V(t.duration),image:t.image})})}function U({onSubmit:t}){const s=C(),r=H(),i=v({resolver:S(R),mode:"onChange",defaultValues:{title:"",description:"",startPrice:0,duration:{days:10,hours:0,minutes:0}}});return e.jsx("div",{className:"w-full px-50 py-30",children:e.jsxs("div",{className:"max-w-[973px] mx-auto flex flex-col gap-25",children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsx("div",{className:"text-5xl font-bold text-scale-600",children:"경매 등록하기"}),e.jsx("div",{className:"text-2xl text-scale-400",children:"당신의 애착템, 술잔으로 걸어보세요!"})]}),e.jsx(y,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(async a=>{const n=await r.mutateAsync({title:a.title,description:a.description,startPrice:a.startPrice,duration:a.duration,image:a.image});if(!n)return;t?.({title:a.title,description:a.description,image:a.image,startPriceCup:a.startPrice,duration:{d:a.duration.days,h:a.duration.hours,m:a.duration.minutes}});const l=n.id;l&&s(P.AUCTION.ROOM.replace(":auctionId",String(l)))}),className:"w-full rounded-2xl bg-bg-white flex flex-col gap-25 shadow-xl px-35 py-22.5",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-12",children:[e.jsx(A,{}),e.jsx(D,{}),e.jsx(O,{}),e.jsxs("div",{className:"w-full flex gap-38",children:[e.jsx(I,{}),e.jsx(E,{})]})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(M,{type:"submit",variant:i.formState.isValid?"primary":"disabled",disabled:!i.formState.isValid||r.isPending,className:"w-80 h-14",children:r.isPending?"경매 등록 중...":"상품 등록하기"})}),r.isError&&e.jsx("p",{className:"text-point-warning text-center text-base",children:"경매 등록에 실패했습니다. 잠시 후 다시 시도해주세요."})]})})]})})}export{U as default};
